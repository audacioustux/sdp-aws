version: '3'

tasks:
  deps:
    cmd: pulumi install

  format:
    deps: [deps]
    cmd: pnpm run format

  up:
    deps: [deps]
    env:
      PULUMI_K8S_ENABLE_SERVER_SIDE_APPLY: true
      PULUMI_K8S_CLIENT_TIMEOUT: 90
    cmd: pulumi up -s prod {{.CLI_ARGS}}
